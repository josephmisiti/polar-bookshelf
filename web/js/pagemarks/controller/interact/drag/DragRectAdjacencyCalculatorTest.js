"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Rects_1 = require("../../../../Rects");
const chai_1 = require("chai");
const DragRectAdjacencyCalculator_1 = require("./DragRectAdjacencyCalculator");
const Assertions_1 = require("../../../../test/Assertions");
const RectArt_1 = require("../../../../util/RectArt");
describe('DragRectAdjacencyCalculator', function () {
    describe("templated tests", function () {
        test("DRAG_LEFT_TOWARD_RESTRICTION", {
            "primaryRect": {
                "left": 50,
                "top": 0,
                "right": 350,
                "bottom": 500,
                "width": 300,
                "height": 500
            },
            "secondaryRect": {
                "left": 0,
                "top": 0,
                "right": 200,
                "bottom": 500,
                "width": 200,
                "height": 500
            },
            "adjustments": {
                "horizontal": {
                    "overlapped": true,
                    "start": 200,
                    "previous": 50,
                    "snapped": "AFTER",
                    "delta": 150,
                    "axis": "x"
                },
                "vertical": {
                    "overlapped": false,
                    "start": 0,
                    "snapped": null,
                    "axis": "y"
                }
            },
            "adjustment": {
                "overlapped": true,
                "start": 200,
                "previous": 50,
                "snapped": "AFTER",
                "delta": 150,
                "axis": "x"
            },
            "adjustedRect": {
                "left": 200,
                "top": 0,
                "right": 500,
                "bottom": 500,
                "width": 300,
                "height": 500
            }
        });
        function test(name, expected) {
            it(name, () => {
                const mockData = MockRects[name];
                let { primaryRect, intersectedRect, restrictionRect } = mockData;
                primaryRect = Rects_1.Rects.createFromBasicRect(primaryRect);
                intersectedRect = Rects_1.Rects.createFromBasicRect(intersectedRect);
                restrictionRect = Rects_1.Rects.createFromBasicRect(restrictionRect);
                const adjacency = DragRectAdjacencyCalculator_1.DragRectAdjacencyCalculator.calculate(primaryRect, intersectedRect, restrictionRect);
                chai_1.assert.notEqual(adjacency.adjustment, null);
                Assertions_1.assertJSON(adjacency, expected);
            });
        }
    });
    it("Primary coming from the left, horizontal, snapping before due to restriction rect in place.", function () {
        const primaryRect = Rects_1.Rects.createFromBasicRect({ left: 1, top: 0, width: 10, height: 10 });
        const secondaryRect = Rects_1.Rects.createFromBasicRect({ left: 10, top: 0, width: 10, height: 10 });
        const restrictionRect = Rects_1.Rects.createFromBasicRect({ left: 0, top: 0, width: 50, height: 50 });
        console.log("BEFORE: " + RectArt_1.RectArt.formatRects([secondaryRect, primaryRect]).toString());
        const adjacency = DragRectAdjacencyCalculator_1.DragRectAdjacencyCalculator.calculate(primaryRect, secondaryRect, restrictionRect);
        chai_1.assert.notEqual(adjacency.adjustment, null);
        chai_1.assert.equal(adjacency.adjustment.overlapped, true);
        chai_1.assert.equal(adjacency.adjustment.snapped, "BEFORE");
        const expected = {
            "left": 0,
            "top": 0,
            "right": 10,
            "bottom": 10,
            "width": 10,
            "height": 10
        };
        Assertions_1.assertJSON(adjacency.adjustedRect, expected);
    });
    it("Primary coming from the left, horizontal, snapping before due to restriction rect in place.", function () {
        const primaryRect = Rects_1.Rects.createFromBasicRect({ left: 1, top: 0, width: 10, height: 10 });
        const secondaryRect = Rects_1.Rects.createFromBasicRect({ left: 10, top: 0, width: 10, height: 10 });
        const restrictionRect = Rects_1.Rects.createFromBasicRect({ left: 0, top: 0, width: 50, height: 50 });
        console.log("BEFORE: " + RectArt_1.RectArt.formatRects([secondaryRect, primaryRect]).toString());
        const adjacency = DragRectAdjacencyCalculator_1.DragRectAdjacencyCalculator.calculate(primaryRect, secondaryRect, restrictionRect);
        chai_1.assert.notEqual(adjacency.adjustment, null);
        chai_1.assert.equal(adjacency.adjustment.overlapped, true);
        chai_1.assert.equal(adjacency.adjustment.snapped, "BEFORE");
        const expected = {
            "left": 0,
            "top": 0,
            "right": 10,
            "bottom": 10,
            "width": 10,
            "height": 10
        };
        Assertions_1.assertJSON(adjacency.adjustedRect, expected);
    });
    it("Primary coming from the right, horizontal, snapping after due to restriction rect in place.", function () {
        const primaryRect = Rects_1.Rects.createFromBasicRect({ left: 2, top: 0, width: 10, height: 10 });
        const secondaryRect = Rects_1.Rects.createFromBasicRect({ left: 1, top: 0, width: 10, height: 10 });
        const restrictionRect = Rects_1.Rects.createFromBasicRect({ left: 0, top: 0, width: 50, height: 50 });
        console.log("BEFORE: " + RectArt_1.RectArt.formatRects([secondaryRect, primaryRect]).toString());
        const adjacency = DragRectAdjacencyCalculator_1.DragRectAdjacencyCalculator.calculate(primaryRect, secondaryRect, restrictionRect);
        chai_1.assert.notEqual(adjacency.adjustment, null);
        chai_1.assert.equal(adjacency.adjustment.overlapped, true);
        chai_1.assert.equal(adjacency.adjustment.snapped, "AFTER");
        const expected = {
            "left": 11,
            "top": 0,
            "right": 21,
            "bottom": 10,
            "width": 10,
            "height": 10
        };
        Assertions_1.assertJSON(adjacency.adjustedRect, expected);
    });
    it("Primary coming from the right, horizontal (snapping after)", function () {
        const primaryRect = Rects_1.Rects.createFromBasicRect({ left: 16, top: 10, width: 10, height: 10 });
        const secondaryRect = Rects_1.Rects.createFromBasicRect({ left: 10, top: 10, width: 10, height: 10 });
        console.log("BEFORE: " + RectArt_1.RectArt.formatRects([secondaryRect, primaryRect]).toString());
        const adjacency = DragRectAdjacencyCalculator_1.DragRectAdjacencyCalculator.calculate(primaryRect, secondaryRect);
        console.log("AFTER: " + RectArt_1.RectArt.formatRects([secondaryRect, adjacency.adjustedRect]).toString());
        chai_1.assert.equal(adjacency.adjustments.horizontal.overlapped, true);
        chai_1.assert.equal(adjacency.adjustments.horizontal.snapped, "AFTER");
        const expected = {
            "left": 20,
            "top": 10,
            "right": 30,
            "bottom": 20,
            "width": 10,
            "height": 10
        };
        Assertions_1.assertJSON(adjacency.adjustedRect, expected);
    });
    it("Primary coming from the left, horizontal (snapping before)", function () {
        const primaryRect = Rects_1.Rects.createFromBasicRect({ left: 14, top: 4, width: 10, height: 10, right: 24 });
        const secondaryRect = Rects_1.Rects.createFromBasicRect({ left: 18, top: 4, width: 10, height: 10, right: 28 });
        console.log("BEFORE: " + RectArt_1.RectArt.formatRects([secondaryRect, primaryRect]).toString());
        const adjacency = DragRectAdjacencyCalculator_1.DragRectAdjacencyCalculator.calculate(primaryRect, secondaryRect);
        console.log("AFTER: " + RectArt_1.RectArt.formatRects([secondaryRect, adjacency.adjustedRect]).toString());
        chai_1.assert.equal(adjacency.adjustments.horizontal.overlapped, true);
        chai_1.assert.equal(adjacency.adjustments.horizontal.snapped, "BEFORE");
        const expected = {
            "left": 8,
            "top": 4,
            "right": 18,
            "bottom": 14,
            "width": 10,
            "height": 10
        };
        Assertions_1.assertJSON(adjacency.adjustedRect, expected);
    });
    xit("No horizontal overlap", function () {
        const primaryRect = Rects_1.Rects.createFromBasicRect({ left: 14, top: 4, width: 10, height: 10, right: 24 });
        const secondaryRect = Rects_1.Rects.createFromBasicRect({ left: 30, top: 4, width: 10, height: 10, right: 28 });
        console.log("BEFORE: " + RectArt_1.RectArt.formatRects([secondaryRect, primaryRect]).toString());
        const adjacency = DragRectAdjacencyCalculator_1.DragRectAdjacencyCalculator.calculate(primaryRect, secondaryRect);
        console.log("AFTER: " + RectArt_1.RectArt.formatRects([secondaryRect, adjacency.adjustedRect]).toString());
        chai_1.assert.equal(adjacency.adjustments.horizontal.overlapped, false);
        chai_1.assert.equal(adjacency.adjustments.horizontal.snapped, null);
        Assertions_1.assertJSON(adjacency.adjustedRect, primaryRect);
    });
    it("Primary coming from the bottom, vertical (snapping after)", function () {
        const primaryRect = Rects_1.Rects.createFromBasicRect({ left: 10, top: 16, width: 10, height: 10 });
        const secondaryRect = Rects_1.Rects.createFromBasicRect({ left: 10, top: 10, width: 10, height: 10 });
        console.log("BEFORE: " + RectArt_1.RectArt.formatRects([secondaryRect, primaryRect]).toString());
        const adjacency = DragRectAdjacencyCalculator_1.DragRectAdjacencyCalculator.calculate(primaryRect, secondaryRect);
        console.log("AFTER: " + RectArt_1.RectArt.formatRects([secondaryRect, adjacency.adjustedRect]).toString());
        chai_1.assert.equal(adjacency.adjustment.overlapped, true);
        chai_1.assert.equal(adjacency.adjustment.snapped, "AFTER");
        const expected = {
            "left": 10,
            "top": 20,
            "right": 20,
            "bottom": 30,
            "width": 10,
            "height": 10
        };
        Assertions_1.assertJSON(adjacency.adjustedRect, expected);
    });
    it("Large box coming from left", function () {
        const primaryRect = Rects_1.Rects.createFromBasicRect({
            "left": 219,
            "top": 128,
            "right": 419,
            "bottom": 328,
            "width": 200,
            "height": 200
        });
        const secondaryRect = Rects_1.Rects.createFromBasicRect({
            "left": 400,
            "top": 150,
            "right": 500,
            "bottom": 250,
            "width": 100,
            "height": 100
        });
        chai_1.assert.equal(Rects_1.Rects.intersect(primaryRect, secondaryRect), true);
        const adjacency = DragRectAdjacencyCalculator_1.DragRectAdjacencyCalculator.calculate(primaryRect, secondaryRect);
        chai_1.assert.equal(adjacency.adjustments.vertical.overlapped, true);
        chai_1.assert.equal(adjacency.adjustments.horizontal.overlapped, true);
        chai_1.assert.equal(adjacency.adjustment !== null, true);
        chai_1.assert.equal(adjacency.adjustment.overlapped, true);
        chai_1.assert.equal(adjacency.adjustment.snapped, "BEFORE");
        const expected = {
            "left": 200,
            "top": 128,
            "right": 400,
            "bottom": 328,
            "width": 200,
            "height": 200
        };
        Assertions_1.assertJSON(adjacency.adjustedRect, expected);
    });
});
const MockRects = {
    DRAG_LEFT_TOWARD_RESTRICTION: {
        primaryRect: {
            "left": 50,
            "top": 0,
            "right": 350,
            "bottom": 500,
        },
        intersectedRect: {
            "left": 0,
            "top": 0,
            "right": 200,
            "bottom": 500,
            "width": 200,
            "height": 500
        },
        restrictionRect: {
            "left": 0,
            "top": 0,
            "right": 800,
            "bottom": 500,
            "width": 800,
            "height": 500
        }
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRHJhZ1JlY3RBZGphY2VuY3lDYWxjdWxhdG9yVGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkRyYWdSZWN0QWRqYWNlbmN5Q2FsY3VsYXRvclRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBd0M7QUFFeEMsK0JBQTRCO0FBQzVCLCtFQUEwRTtBQUMxRSw0REFBdUQ7QUFDdkQsc0RBQWlEO0FBV2pELFFBQVEsQ0FBQyw2QkFBNkIsRUFBRTtJQUVwQyxRQUFRLENBQUMsaUJBQWlCLEVBQUU7UUFFeEIsSUFBSSxDQUFDLDhCQUE4QixFQUFFO1lBQ2pDLGFBQWEsRUFBRTtnQkFDWCxNQUFNLEVBQUUsRUFBRTtnQkFDVixLQUFLLEVBQUUsQ0FBQztnQkFDUixPQUFPLEVBQUUsR0FBRztnQkFDWixRQUFRLEVBQUUsR0FBRztnQkFDYixPQUFPLEVBQUUsR0FBRztnQkFDWixRQUFRLEVBQUUsR0FBRzthQUNoQjtZQUNELGVBQWUsRUFBRTtnQkFDYixNQUFNLEVBQUUsQ0FBQztnQkFDVCxLQUFLLEVBQUUsQ0FBQztnQkFDUixPQUFPLEVBQUUsR0FBRztnQkFDWixRQUFRLEVBQUUsR0FBRztnQkFDYixPQUFPLEVBQUUsR0FBRztnQkFDWixRQUFRLEVBQUUsR0FBRzthQUNoQjtZQUNELGFBQWEsRUFBRTtnQkFDWCxZQUFZLEVBQUU7b0JBQ1YsWUFBWSxFQUFFLElBQUk7b0JBQ2xCLE9BQU8sRUFBRSxHQUFHO29CQUNaLFVBQVUsRUFBRSxFQUFFO29CQUNkLFNBQVMsRUFBRSxPQUFPO29CQUNsQixPQUFPLEVBQUUsR0FBRztvQkFDWixNQUFNLEVBQUUsR0FBRztpQkFDZDtnQkFDRCxVQUFVLEVBQUU7b0JBQ1IsWUFBWSxFQUFFLEtBQUs7b0JBQ25CLE9BQU8sRUFBRSxDQUFDO29CQUNWLFNBQVMsRUFBRSxJQUFJO29CQUNmLE1BQU0sRUFBRSxHQUFHO2lCQUNkO2FBQ0o7WUFDRCxZQUFZLEVBQUU7Z0JBQ1YsWUFBWSxFQUFFLElB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LENBQUUsQ0FBQztJQUVsRCxDQUFDLENBQUMsQ0FBQztBQThEUCxDQUFDLENBQUMsQ0FBQztBQUdILE1BQU0sU0FBUyxHQUFRO0lBRW5CLDRCQUE0QixFQUFFO1FBRTFCLFdBQVcsRUFBRTtZQUNULE1BQU0sRUFBRSxFQUFFO1lBQ1YsS0FBSyxFQUFFLENBQUM7WUFDUixPQUFPLEVBQUUsR0FBRztZQUNaLFFBQVEsRUFBRSxHQUFHO1NBQ2hCO1FBRUQsZUFBZSxFQUFFO1lBQ2IsTUFBTSxFQUFFLENBQUM7WUFDVCxLQUFLLEVBQUUsQ0FBQztZQUNSLE9BQU8sRUFBRSxHQUFHO1lBQ1osUUFBUSxFQUFFLEdBQUc7WUFDYixPQUFPLEVBQUUsR0FBRztZQUNaLFFBQVEsRUFBRSxHQUFHO1NBQ2hCO1FBRUQsZUFBZSxFQUFFO1lBQ2IsTUFBTSxFQUFFLENBQUM7WUFDVCxLQUFLLEVBQUUsQ0FBQztZQUNSLE9BQU8sRUFBRSxHQUFHO1lBQ1osUUFBUSxFQUFFLEdBQUc7WUFDYixPQUFPLEVBQUUsR0FBRztZQUNaLFFBQVEsRUFBRSxHQUFHO1NBQ2hCO0tBRUo7Q0FFSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtSZWN0c30gZnJvbSBcIi4uLy4uLy4uLy4uL1JlY3RzXCI7XG5cbmltcG9ydCB7YXNzZXJ0fSBmcm9tICdjaGFpJztcbmltcG9ydCB7RHJhZ1JlY3RBZGphY2VuY3lDYWxjdWxhdG9yfSBmcm9tIFwiLi9EcmFnUmVjdEFkamFjZW5jeUNhbGN1bGF0b3JcIjtcbmltcG9ydCB7YXNzZXJ0SlNPTn0gZnJvbSBcIi4uLy4uLy4uLy4uL3Rlc3QvQXNzZXJ0aW9uc1wiO1xuaW1wb3J0IHtSZWN0QXJ0fSBmcm9tIFwiLi4vLi4vLi4vLi4vdXRpbC9SZWN0QXJ0XCI7XG5cblxuLy8gY29uc3Qge1JlY3R9ID0gcmVxdWlyZShcIi4uLy4uLy4uLy4uL1JlY3RcIik7XG4vLyBjb25zdCB7UmVjdHN9ID0gcmVxdWlyZShcIi4uLy4uLy4uLy4uL1JlY3RzXCIpO1xuLy8gY29uc3Qge09iamVjdHN9ID0gcmVxdWlyZShcIi4uLy4uLy4uLy4uL3V0aWwvT2JqZWN0c1wiKTtcbi8vIGNvbnN0IHtSZWN0QXJ0fSA9IHJlcXVpcmUoXCIuLi8uLi8uLi8uLi91dGlsL1JlY3RBcnRcIik7XG4vL1xuLy8gY29uc3Qge0RyYWdSZWN0QWRqYWNlbmN5Q2FsY3VsYXRvcn0gPVxuLy8gcmVxdWlyZShcIi4vRHJhZ1JlY3RBZGphY2VuY3lDYWxjdWxhdG9yXCIpO1xuXG5kZXNjcmliZSgnRHJhZ1JlY3RBZGphY2VuY3lDYWxjdWxhdG9yJywgZnVuY3Rpb24oKSB7XG5cbiAgICBkZXNjcmliZShcInRlbXBsYXRlZCB0ZXN0c1wiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICB0ZXN0KFwiRFJBR19MRUZUX1RPV0FSRF9SRVNUUklDVElPTlwiLCB7XG4gICAgICAgICAgICBcInByaW1hcnlSZWN0XCI6IHtcbiAgICAgICAgICAgICAgICBcImxlZnRcIjogNTAsXG4gICAgICAgICAgICAgICAgXCJ0b3BcIjogMCxcbiAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDM1MCxcbiAgICAgICAgICAgICAgICBcImJvdHRvbVwiOiA1MDAsXG4gICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAzMDAsXG4gICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogNTAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJzZWNvbmRhcnlSZWN0XCI6IHtcbiAgICAgICAgICAgICAgICBcImxlZnRcIjogMCxcbiAgICAgICAgICAgICAgICBcInRvcFwiOiAwLFxuICAgICAgICAgICAgICAgIFwicmlnaHRcIjogMjAwLFxuICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDUwMCxcbiAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDIwMCxcbiAgICAgICAgICAgICAgICBcImhlaWdodFwiOiA1MDBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImFkanVzdG1lbnRzXCI6IHtcbiAgICAgICAgICAgICAgICBcImhvcml6b250YWxcIjoge1xuICAgICAgICAgICAgICAgICAgICBcIm92ZXJsYXBwZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJzdGFydFwiOiAyMDAsXG4gICAgICAgICAgICAgICAgICAgIFwicHJldmlvdXNcIjogNTAsXG4gICAgICAgICAgICAgICAgICAgIFwic25hcHBlZFwiOiBcIkFGVEVSXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiZGVsdGFcIjogMTUwLFxuICAgICAgICAgICAgICAgICAgICBcImF4aXNcIjogXCJ4XCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwidmVydGljYWxcIjoge1xuICAgICAgICAgICAgICAgICAgICBcIm92ZXJsYXBwZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIFwic3RhcnRcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgXCJzbmFwcGVkXCI6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIFwiYXhpc1wiOiBcInlcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImFkanVzdG1lbnRcIjoge1xuICAgICAgICAgICAgICAgIFwib3ZlcmxhcHBlZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwic3RhcnRcIjogMjAwLFxuICAgICAgICAgICAgICAgIFwicHJldmlvdXNcIjogNTAsXG4gICAgICAgICAgICAgICAgXCJzbmFwcGVkXCI6IFwiQUZURVJcIixcbiAgICAgICAgICAgICAgICBcImRlbHRhXCI6IDE1MCxcbiAgICAgICAgICAgICAgICBcImF4aXNcIjogXCJ4XCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImFkanVzdGVkUmVjdFwiOiB7XG4gICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDIwMCxcbiAgICAgICAgICAgICAgICBcInRvcFwiOiAwLFxuICAgICAgICAgICAgICAgIFwicmlnaHRcIjogNTAwLFxuICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDUwMCxcbiAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDMwMCxcbiAgICAgICAgICAgICAgICBcImhlaWdodFwiOiA1MDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gdGVzdChuYW1lOiBzdHJpbmcsIGV4cGVjdGVkOiBhbnkpIHtcblxuICAgICAgICAgICAgaXQobmFtZSwgKCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbW9ja0RhdGE6IGFueSA9IE1vY2tSZWN0c1tuYW1lXTtcblxuICAgICAgICAgICAgICAgIGxldCB7cHJpbWFyeVJlY3QsIGludGVyc2VjdGVkUmVjdCwgcmVzdHJpY3Rpb25SZWN0fSA9IG1vY2tEYXRhO1xuXG4gICAgICAgICAgICAgICAgcHJpbWFyeVJlY3QgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KHByaW1hcnlSZWN0KTtcbiAgICAgICAgICAgICAgICBpbnRlcnNlY3RlZFJlY3QgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KGludGVyc2VjdGVkUmVjdCk7XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Rpb25SZWN0ID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdChyZXN0cmljdGlvblJlY3QpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgYWRqYWNlbmN5ID0gRHJhZ1JlY3RBZGphY2VuY3lDYWxjdWxhdG9yLmNhbGN1bGF0ZShwcmltYXJ5UmVjdCwgaW50ZXJzZWN0ZWRSZWN0LCByZXN0cmljdGlvblJlY3QpO1xuXG4gICAgICAgICAgICAgICAgYXNzZXJ0Lm5vdEVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50LCBudWxsKTtcblxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiQUZURVI6IFwiICsgUmVjdEFydC5mb3JtYXRSZWN0cyhbc2Vjb25kYXJ5UmVjdCxcbiAgICAgICAgICAgICAgICAvLyBhZGphY2VuY3kuYWRqdXN0ZWRSZWN0XSkudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgICAgICAgICBhc3NlcnRKU09OKGFkamFjZW5jeSwgZXhwZWN0ZWQgKTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG5cbiAgICBpdChcIlByaW1hcnkgY29taW5nIGZyb20gdGhlIGxlZnQsIGhvcml6b250YWwsIHNuYXBwaW5nIGJlZm9yZSBkdWUgdG8gcmVzdHJpY3Rpb24gcmVjdCBpbiBwbGFjZS5cIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY29uc3QgcHJpbWFyeVJlY3QgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KHtsZWZ0OiAxLCB0b3A6IDAsIHdpZHRoOiAxMCwgaGVpZ2h0OiAxMH0pO1xuICAgICAgICBjb25zdCBzZWNvbmRhcnlSZWN0ID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7bGVmdDogMTAsIHRvcDogMCwgd2lkdGg6IDEwLCBoZWlnaHQ6IDEwfSk7XG4gICAgICAgIGNvbnN0IHJlc3RyaWN0aW9uUmVjdCA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe2xlZnQ6IDAsIHRvcDogMCwgd2lkdGg6IDUwLCBoZWlnaHQ6IDUwfSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJCRUZPUkU6IFwiICsgUmVjdEFydC5mb3JtYXRSZWN0cyhbc2Vjb25kYXJ5UmVjdCwgcHJpbWFyeVJlY3RdKS50b1N0cmluZygpKTtcblxuICAgICAgICBjb25zdCBhZGphY2VuY3kgPSBEcmFnUmVjdEFkamFjZW5jeUNhbGN1bGF0b3IuY2FsY3VsYXRlKHByaW1hcnlSZWN0LCBzZWNvbmRhcnlSZWN0LCByZXN0cmljdGlvblJlY3QpO1xuXG4gICAgICAgIGFzc2VydC5ub3RFcXVhbChhZGphY2VuY3kuYWRqdXN0bWVudCwgbnVsbCk7XG5cbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJBRlRFUjogXCIgKyBSZWN0QXJ0LmZvcm1hdFJlY3RzKFtzZWNvbmRhcnlSZWN0LFxuICAgICAgICAvLyBhZGphY2VuY3kuYWRqdXN0ZWRSZWN0XSkudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50Lm92ZXJsYXBwZWQsIHRydWUpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoYWRqYWNlbmN5LmFkanVzdG1lbnQuc25hcHBlZCwgXCJCRUZPUkVcIik7XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSB7XG4gICAgICAgICAgICBcImxlZnRcIjogMCxcbiAgICAgICAgICAgIFwidG9wXCI6IDAsXG4gICAgICAgICAgICBcInJpZ2h0XCI6IDEwLFxuICAgICAgICAgICAgXCJib3R0b21cIjogMTAsXG4gICAgICAgICAgICBcIndpZHRoXCI6IDEwLFxuICAgICAgICAgICAgXCJoZWlnaHRcIjogMTBcbiAgICAgICAgfTtcblxuICAgICAgICBhc3NlcnRKU09OKGFkamFjZW5jeS5hZGp1c3RlZFJlY3QsIGV4cGVjdGVkICk7XG5cbiAgICB9KTtcblxuXG4gICAgaXQoXCJQcmltYXJ5IGNvbWluZyBmcm9tIHRoZSBsZWZ0LCBob3Jpem9udGFsLCBzbmFwcGluZyBiZWZvcmUgZHVlIHRvIHJlc3RyaWN0aW9uIHJlY3QgaW4gcGxhY2UuXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGNvbnN0IHByaW1hcnlSZWN0ID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7bGVmdDogMSwgdG9wOiAwLCB3aWR0aDogMTAsIGhlaWdodDogMTB9KTtcbiAgICAgICAgY29uc3Qgc2Vjb25kYXJ5UmVjdCA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe2xlZnQ6IDEwLCB0b3A6IDAsIHdpZHRoOiAxMCwgaGVpZ2h0OiAxMH0pO1xuICAgICAgICBjb25zdCByZXN0cmljdGlvblJlY3QgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KHtsZWZ0OiAwLCB0b3A6IDAsIHdpZHRoOiA1MCwgaGVpZ2h0OiA1MH0pO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQkVGT1JFOiBcIiArIFJlY3RBcnQuZm9ybWF0UmVjdHMoW3NlY29uZGFyeVJlY3QsIHByaW1hcnlSZWN0XSkudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgY29uc3QgYWRqYWNlbmN5ID0gRHJhZ1JlY3RBZGphY2VuY3lDYWxjdWxhdG9yLmNhbGN1bGF0ZShwcmltYXJ5UmVjdCwgc2Vjb25kYXJ5UmVjdCwgcmVzdHJpY3Rpb25SZWN0KTtcblxuICAgICAgICBhc3NlcnQubm90RXF1YWwoYWRqYWNlbmN5LmFkanVzdG1lbnQsIG51bGwpO1xuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiQUZURVI6IFwiICsgUmVjdEFydC5mb3JtYXRSZWN0cyhbc2Vjb25kYXJ5UmVjdCxcbiAgICAgICAgLy8gYWRqYWNlbmN5LmFkanVzdGVkUmVjdF0pLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIGFzc2VydC5lcXVhbChhZGphY2VuY3kuYWRqdXN0bWVudC5vdmVybGFwcGVkLCB0cnVlKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50LnNuYXBwZWQsIFwiQkVGT1JFXCIpO1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkID0ge1xuICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICBcInRvcFwiOiAwLFxuICAgICAgICAgICAgXCJyaWdodFwiOiAxMCxcbiAgICAgICAgICAgIFwiYm90dG9tXCI6IDEwLFxuICAgICAgICAgICAgXCJ3aWR0aFwiOiAxMCxcbiAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDEwXG4gICAgICAgIH07XG5cbiAgICAgICAgYXNzZXJ0SlNPTihhZGphY2VuY3kuYWRqdXN0ZWRSZWN0LCBleHBlY3RlZCApO1xuXG4gICAgfSk7XG5cbiAgICBpdChcIlByaW1hcnkgY29taW5nIGZyb20gdGhlIHJpZ2h0LCBob3Jpem9udGFsLCBzbmFwcGluZyBhZnRlciBkdWUgdG8gcmVzdHJpY3Rpb24gcmVjdCBpbiBwbGFjZS5cIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY29uc3QgcHJpbWFyeVJlY3QgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KHtsZWZ0OiAyLCB0b3A6IDAsIHdpZHRoOiAxMCwgaGVpZ2h0OiAxMH0pO1xuICAgICAgICBjb25zdCBzZWNvbmRhcnlSZWN0ID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7bGVmdDogMSwgdG9wOiAwLCB3aWR0aDogMTAsIGhlaWdodDogMTB9KTtcbiAgICAgICAgY29uc3QgcmVzdHJpY3Rpb25SZWN0ID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7bGVmdDogMCwgdG9wOiAwLCB3aWR0aDogNTAsIGhlaWdodDogNTB9KTtcblxuICAgICAgICBjb25zb2xlLmxvZyhcIkJFRk9SRTogXCIgKyBSZWN0QXJ0LmZvcm1hdFJlY3RzKFtzZWNvbmRhcnlSZWN0LCBwcmltYXJ5UmVjdF0pLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIGNvbnN0IGFkamFjZW5jeSA9IERyYWdSZWN0QWRqYWNlbmN5Q2FsY3VsYXRvci5jYWxjdWxhdGUocHJpbWFyeVJlY3QsIHNlY29uZGFyeVJlY3QsIHJlc3RyaWN0aW9uUmVjdCk7XG5cbiAgICAgICAgYXNzZXJ0Lm5vdEVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50LCBudWxsKTtcblxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkFGVEVSOiBcIiArIFJlY3RBcnQuZm9ybWF0UmVjdHMoW3NlY29uZGFyeVJlY3QsXG4gICAgICAgIC8vIGFkamFjZW5jeS5hZGp1c3RlZFJlY3RdKS50b1N0cmluZygpKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoYWRqYWNlbmN5LmFkanVzdG1lbnQub3ZlcmxhcHBlZCwgdHJ1ZSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChhZGphY2VuY3kuYWRqdXN0bWVudC5zbmFwcGVkLCBcIkFGVEVSXCIpO1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkID0ge1xuICAgICAgICAgICAgXCJsZWZ0XCI6IDExLFxuICAgICAgICAgICAgXCJ0b3BcIjogMCxcbiAgICAgICAgICAgIFwicmlnaHRcIjogMjEsXG4gICAgICAgICAgICBcImJvdHRvbVwiOiAxMCxcbiAgICAgICAgICAgIFwid2lkdGhcIjogMTAsXG4gICAgICAgICAgICBcImhlaWdodFwiOiAxMFxuICAgICAgICB9O1xuXG4gICAgICAgIGFzc2VydEpTT04oYWRqYWNlbmN5LmFkanVzdGVkUmVjdCwgZXhwZWN0ZWQgKTtcblxuICAgIH0pO1xuXG4gICAgaXQoXCJQcmltYXJ5IGNvbWluZyBmcm9tIHRoZSByaWdodCwgaG9yaXpvbnRhbCAoc25hcHBpbmcgYWZ0ZXIpXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGNvbnN0IHByaW1hcnlSZWN0ID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7bGVmdDogMTYsIHRvcDogMTAsIHdpZHRoOiAxMCwgaGVpZ2h0OiAxMH0pO1xuXG4gICAgICAgIGNvbnN0IHNlY29uZGFyeVJlY3QgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KHtsZWZ0OiAxMCwgdG9wOiAxMCwgd2lkdGg6IDEwLCBoZWlnaHQ6IDEwfSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJCRUZPUkU6IFwiICsgUmVjdEFydC5mb3JtYXRSZWN0cyhbc2Vjb25kYXJ5UmVjdCwgcHJpbWFyeVJlY3RdKS50b1N0cmluZygpKTtcblxuICAgICAgICBjb25zdCBhZGphY2VuY3kgPSBEcmFnUmVjdEFkamFjZW5jeUNhbGN1bGF0b3IuY2FsY3VsYXRlKHByaW1hcnlSZWN0LCBzZWNvbmRhcnlSZWN0KTtcblxuICAgICAgICBjb25zb2xlLmxvZyhcIkFGVEVSOiBcIiArIFJlY3RBcnQuZm9ybWF0UmVjdHMoW3NlY29uZGFyeVJlY3QsIGFkamFjZW5jeS5hZGp1c3RlZFJlY3RdKS50b1N0cmluZygpKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoYWRqYWNlbmN5LmFkanVzdG1lbnRzLmhvcml6b250YWwub3ZlcmxhcHBlZCwgdHJ1ZSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChhZGphY2VuY3kuYWRqdXN0bWVudHMuaG9yaXpvbnRhbC5zbmFwcGVkLCBcIkFGVEVSXCIpO1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkID0ge1xuICAgICAgICAgICAgXCJsZWZ0XCI6IDIwLFxuICAgICAgICAgICAgXCJ0b3BcIjogMTAsXG4gICAgICAgICAgICBcInJpZ2h0XCI6IDMwLFxuICAgICAgICAgICAgXCJib3R0b21cIjogMjAsXG4gICAgICAgICAgICBcIndpZHRoXCI6IDEwLFxuICAgICAgICAgICAgXCJoZWlnaHRcIjogMTBcbiAgICAgICAgfTtcblxuICAgICAgICBhc3NlcnRKU09OKGFkamFjZW5jeS5hZGp1c3RlZFJlY3QsIGV4cGVjdGVkICk7XG5cbiAgICB9KTtcblxuICAgIGl0KFwiUHJpbWFyeSBjb21pbmcgZnJvbSB0aGUgbGVmdCwgaG9yaXpvbnRhbCAoc25hcHBpbmcgYmVmb3JlKVwiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICBjb25zdCBwcmltYXJ5UmVjdCA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe2xlZnQ6IDE0LCB0b3A6IDQsIHdpZHRoOiAxMCwgaGVpZ2h0OiAxMCwgcmlnaHQ6IDI0fSk7XG5cbiAgICAgICAgY29uc3Qgc2Vjb25kYXJ5UmVjdCA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe2xlZnQ6IDE4LCB0b3A6IDQsIHdpZHRoOiAxMCwgaGVpZ2h0OiAxMCwgcmlnaHQ6IDI4fSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJCRUZPUkU6IFwiICsgUmVjdEFydC5mb3JtYXRSZWN0cyhbc2Vjb25kYXJ5UmVjdCwgcHJpbWFyeVJlY3RdKS50b1N0cmluZygpKTtcblxuICAgICAgICBjb25zdCBhZGphY2VuY3kgPSBEcmFnUmVjdEFkamFjZW5jeUNhbGN1bGF0b3IuY2FsY3VsYXRlKHByaW1hcnlSZWN0LCBzZWNvbmRhcnlSZWN0KTtcblxuICAgICAgICAvLyBhc3NlcnQuZXF1YWwoYWRqYWNlbmN5LmFkanVzdG1lbnRzLnZlcnRpY2FsLm92ZXJsYXBwZWQsIGZhbHNlKTtcbiAgICAgICAgLy8gYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RlZFJlY3QudG9wLCA0KTtcblxuICAgICAgICBjb25zb2xlLmxvZyhcIkFGVEVSOiBcIiArIFJlY3RBcnQuZm9ybWF0UmVjdHMoW3NlY29uZGFyeVJlY3QsIGFkamFjZW5jeS5hZGp1c3RlZFJlY3RdKS50b1N0cmluZygpKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoYWRqYWNlbmN5LmFkanVzdG1lbnRzLmhvcml6b250YWwub3ZlcmxhcHBlZCwgdHJ1ZSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChhZGphY2VuY3kuYWRqdXN0bWVudHMuaG9yaXpvbnRhbC5zbmFwcGVkLCBcIkJFRk9SRVwiKTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZCA9IHtcbiAgICAgICAgICAgIFwibGVmdFwiOiA4LFxuICAgICAgICAgICAgXCJ0b3BcIjogNCxcbiAgICAgICAgICAgIFwicmlnaHRcIjogMTgsXG4gICAgICAgICAgICBcImJvdHRvbVwiOiAxNCxcbiAgICAgICAgICAgIFwid2lkdGhcIjogMTAsXG4gICAgICAgICAgICBcImhlaWdodFwiOiAxMFxuICAgICAgICB9O1xuXG4gICAgICAgIGFzc2VydEpTT04oYWRqYWNlbmN5LmFkanVzdGVkUmVjdCwgZXhwZWN0ZWQpO1xuXG4gICAgfSk7XG5cbiAgICB4aXQoXCJObyBob3Jpem9udGFsIG92ZXJsYXBcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY29uc3QgcHJpbWFyeVJlY3QgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KHtsZWZ0OiAxNCwgdG9wOiA0LCB3aWR0aDogMTAsIGhlaWdodDogMTAsIHJpZ2h0OiAyNH0pO1xuXG4gICAgICAgIGNvbnN0IHNlY29uZGFyeVJlY3QgPSBSZWN0cy5jcmVhdGVGcm9tQmFzaWNSZWN0KHtsZWZ0OiAzMCwgdG9wOiA0LCB3aWR0aDogMTAsIGhlaWdodDogMTAsIHJpZ2h0OiAyOH0pO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQkVGT1JFOiBcIiArIFJlY3RBcnQuZm9ybWF0UmVjdHMoW3NlY29uZGFyeVJlY3QsIHByaW1hcnlSZWN0XSkudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgY29uc3QgYWRqYWNlbmN5ID0gRHJhZ1JlY3RBZGphY2VuY3lDYWxjdWxhdG9yLmNhbGN1bGF0ZShwcmltYXJ5UmVjdCwgc2Vjb25kYXJ5UmVjdCk7XG5cbiAgICAgICAgLy8gYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50cy52ZXJ0aWNhbC5vdmVybGFwcGVkLCBmYWxzZSk7XG4gICAgICAgIC8vIGFzc2VydC5lcXVhbChhZGphY2VuY3kuYWRqdXN0ZWRSZWN0LnRvcCwgNCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJBRlRFUjogXCIgKyBSZWN0QXJ0LmZvcm1hdFJlY3RzKFtzZWNvbmRhcnlSZWN0LCBhZGphY2VuY3kuYWRqdXN0ZWRSZWN0XSkudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50cy5ob3Jpem9udGFsLm92ZXJsYXBwZWQsIGZhbHNlKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50cy5ob3Jpem9udGFsLnNuYXBwZWQsIG51bGwpO1xuXG4gICAgICAgIGFzc2VydEpTT04oYWRqYWNlbmN5LmFkanVzdGVkUmVjdCwgcHJpbWFyeVJlY3QpO1xuXG4gICAgfSk7XG5cblxuICAgIGl0KFwiUHJpbWFyeSBjb21pbmcgZnJvbSB0aGUgYm90dG9tLCB2ZXJ0aWNhbCAoc25hcHBpbmcgYWZ0ZXIpXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGNvbnN0IHByaW1hcnlSZWN0ID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7bGVmdDogMTAsIHRvcDogMTYsIHdpZHRoOiAxMCwgaGVpZ2h0OiAxMH0pO1xuXG5cbiAgICAgICAgY29uc3Qgc2Vjb25kYXJ5UmVjdCA9IFJlY3RzLmNyZWF0ZUZyb21CYXNpY1JlY3Qoe2xlZnQ6IDEwLCB0b3A6IDEwLCB3aWR0aDogMTAsIGhlaWdodDogMTB9KTtcblxuICAgICAgICBjb25zb2xlLmxvZyhcIkJFRk9SRTogXCIgKyBSZWN0QXJ0LmZvcm1hdFJlY3RzKFtzZWNvbmRhcnlSZWN0LCBwcmltYXJ5UmVjdF0pLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIGNvbnN0IGFkamFjZW5jeSA9IERyYWdSZWN0QWRqYWNlbmN5Q2FsY3VsYXRvci5jYWxjdWxhdGUocHJpbWFyeVJlY3QsIHNlY29uZGFyeVJlY3QpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQUZURVI6IFwiICsgUmVjdEFydC5mb3JtYXRSZWN0cyhbc2Vjb25kYXJ5UmVjdCwgYWRqYWNlbmN5LmFkanVzdGVkUmVjdF0pLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIGFzc2VydC5lcXVhbChhZGphY2VuY3kuYWRqdXN0bWVudC5vdmVybGFwcGVkLCB0cnVlKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50LnNuYXBwZWQsIFwiQUZURVJcIik7XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSB7XG4gICAgICAgICAgICBcImxlZnRcIjogMTAsXG4gICAgICAgICAgICBcInRvcFwiOiAyMCxcbiAgICAgICAgICAgIFwicmlnaHRcIjogMjAsXG4gICAgICAgICAgICBcImJvdHRvbVwiOiAzMCxcbiAgICAgICAgICAgIFwid2lkdGhcIjogMTAsXG4gICAgICAgICAgICBcImhlaWdodFwiOiAxMFxuICAgICAgICB9O1xuXG4gICAgICAgIGFzc2VydEpTT04oYWRqYWNlbmN5LmFkanVzdGVkUmVjdCwgZXhwZWN0ZWQgKTtcblxuICAgIH0pO1xuXG5cbiAgICBpdChcIkxhcmdlIGJveCBjb21pbmcgZnJvbSBsZWZ0XCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGNvbnN0IHByaW1hcnlSZWN0ID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7XG4gICAgICAgICAgICBcImxlZnRcIjogMjE5LFxuICAgICAgICAgICAgXCJ0b3BcIjogMTI4LFxuICAgICAgICAgICAgXCJyaWdodFwiOiA0MTksXG4gICAgICAgICAgICBcImJvdHRvbVwiOiAzMjgsXG4gICAgICAgICAgICBcIndpZHRoXCI6IDIwMCxcbiAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDIwMFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBzZWNvbmRhcnlSZWN0ID0gUmVjdHMuY3JlYXRlRnJvbUJhc2ljUmVjdCh7XG4gICAgICAgICAgICBcImxlZnRcIjogNDAwLFxuICAgICAgICAgICAgXCJ0b3BcIjogMTUwLFxuICAgICAgICAgICAgXCJyaWdodFwiOiA1MDAsXG4gICAgICAgICAgICBcImJvdHRvbVwiOiAyNTAsXG4gICAgICAgICAgICBcIndpZHRoXCI6IDEwMCxcbiAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDEwMFxuICAgICAgICB9KTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoUmVjdHMuaW50ZXJzZWN0KHByaW1hcnlSZWN0LCBzZWNvbmRhcnlSZWN0KSwgdHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgYWRqYWNlbmN5ID0gRHJhZ1JlY3RBZGphY2VuY3lDYWxjdWxhdG9yLmNhbGN1bGF0ZShwcmltYXJ5UmVjdCwgc2Vjb25kYXJ5UmVjdCk7XG5cbiAgICAgICAgYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50cy52ZXJ0aWNhbC5vdmVybGFwcGVkLCB0cnVlKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50cy5ob3Jpem9udGFsLm92ZXJsYXBwZWQsIHRydWUpO1xuXG4gICAgICAgIGFzc2VydC5lcXVhbChhZGphY2VuY3kuYWRqdXN0bWVudCAhPT0gbnVsbCwgdHJ1ZSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChhZGphY2VuY3kuYWRqdXN0bWVudC5vdmVybGFwcGVkLCB0cnVlKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGFkamFjZW5jeS5hZGp1c3RtZW50LnNuYXBwZWQsIFwiQkVGT1JFXCIpO1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkID0ge1xuICAgICAgICAgICAgXCJsZWZ0XCI6IDIwMCxcbiAgICAgICAgICAgIFwidG9wXCI6IDEyOCxcbiAgICAgICAgICAgIFwicmlnaHRcIjogNDAwLFxuICAgICAgICAgICAgXCJib3R0b21cIjogMzI4LFxuICAgICAgICAgICAgXCJ3aWR0aFwiOiAyMDAsXG4gICAgICAgICAgICBcImhlaWdodFwiOiAyMDBcbiAgICAgICAgfTtcblxuICAgICAgICBhc3NlcnRKU09OKGFkamFjZW5jeS5hZGp1c3RlZFJlY3QsIGV4cGVjdGVkICk7XG5cbiAgICB9KTtcblxuXG4gICAgLy9cbiAgICAvLyBpbnRlcnNlY3RlZFBhZ2VtYXJrczogIHtcbiAgICAvLyAgICAgXCJlbGVtZW50UmVjdFwiOiB7XG4gICAgLy8gICAgICAgICBcImxlZnRcIjogMzAxLFxuICAgIC8vICAgICAgICAgICAgIFwidG9wXCI6IDEzNyxcbiAgICAvLyAgICAgICAgICAgICBcInJpZ2h0XCI6IDUwMSxcbiAgICAvLyAgICAgICAgICAgICBcImJvdHRvbVwiOiAzMzcsXG4gICAgLy8gICAgICAgICAgICAgXCJ3aWR0aFwiOiAyMDAsXG4gICAgLy8gICAgICAgICAgICAgXCJoZWlnaHRcIjogMjAwXG4gICAgLy8gICAgIH0sXG4gICAgLy8gICAgIFwiaW50ZXJzZWN0ZWRSZWN0c1wiOiBbXG4gICAgLy8gICAgICAgICB7XG4gICAgLy8gICAgICAgICAgICAgXCJsZWZ0XCI6IDQwMCxcbiAgICAvLyAgICAgICAgICAgICBcInRvcFwiOiAxNTAsXG4gICAgLy8gICAgICAgICAgICAgXCJyaWdodFwiOiA1MDAsXG4gICAgLy8gICAgICAgICAgICAgXCJib3R0b21cIjogMjUwLFxuICAgIC8vICAgICAgICAgICAgIFwid2lkdGhcIjogMTAwLFxuICAgIC8vICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDEwMFxuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICBdXG4gICAgLy8gfVxuICAgIC8vXG5cbiAgICAvLyBhZGphY2VuY3k6IHtcbiAgICAvLyB7XG4gICAgLy8gICAgIFwicHJpbWFyeVJlY3RcIjoge1xuICAgIC8vICAgICBcImxlZnRcIjogMzAxLFxuICAgIC8vICAgICAgICAgXCJ0b3BcIjogMTM3LFxuICAgIC8vICAgICAgICAgXCJyaWdodFwiOiA1MDEsXG4gICAgLy8gICAgICAgICBcImJvdHRvbVwiOiAzMzcsXG4gICAgLy8gICAgICAgICBcIndpZHRoXCI6IDIwMCxcbiAgICAvLyAgICAgICAgIFwiaGVpZ2h0XCI6IDIwMFxuICAgIC8vIH0sXG4gICAgLy8gICAgIFwic2Vjb25kYXJ5UmVjdFwiOiB7XG4gICAgLy8gICAgIFwibGVmdFwiOiA0MDAsXG4gICAgLy8gICAgICAgICBcInRvcFwiOiAxNTAsXG4gICAgLy8gICAgICAgICBcInJpZ2h0XCI6IDUwMCxcbiAgICAvLyAgICAgICAgIFwiYm90dG9tXCI6IDI1MCxcbiAgICAvLyAgICAgICAgIFwid2lkdGhcIjogMTAwLFxuICAgIC8vICAgICAgICAgXCJoZWlnaHRcIjogMTAwXG4gICAgLy8gfSxcbiAgICAvLyAgICAgXCJhZGp1c3RtZW50c1wiOiB7XG4gICAgLy8gICAgIFwiaG9yaXpvbnRhbFwiOiB7XG4gICAgLy8gICAgICAgICBcIm92ZXJsYXBwZWRcIjogZmFsc2UsXG4gICAgLy8gICAgICAgICAgICAgXCJzdGFydFwiOiAzMDEsXG4gICAgLy8gICAgICAgICAgICAgXCJzbmFwcGVkXCI6IG51bGwsXG4gICAgLy8gICAgICAgICAgICAgXCJheGlzXCI6IFwieFwiXG4gICAgLy8gICAgIH0sXG4gICAgLy8gICAgIFwidmVydGljYWxcIjoge1xuICAgIC8vICAgICAgICAgXCJvdmVybGFwcGVkXCI6IGZhbHNlLFxuICAgIC8vICAgICAgICAgICAgIFwic3RhcnRcIjogMTM3LFxuICAgIC8vICAgICAgICAgICAgIFwic25hcHBlZFwiOiBudWxsLFxuICAgIC8vICAgICAgICAgICAgIFwiYXhpc1wiOiBcInlcIlxuICAgIC8vICAgICB9XG4gICAgLy8gfSxcbiAgICAvLyAgICAgXCJhZGp1c3RtZW50XCI6IG51bGwsXG4gICAgLy8gICAgIFwiYWRqdXN0ZWRSZWN0XCI6IG51bGxcbiAgICAvLyB9XG5cbn0pO1xuXG5cbmNvbnN0IE1vY2tSZWN0czogYW55ID0ge1xuXG4gICAgRFJBR19MRUZUX1RPV0FSRF9SRVNUUklDVElPTjoge1xuXG4gICAgICAgIHByaW1hcnlSZWN0OiB7XG4gICAgICAgICAgICBcImxlZnRcIjogNTAsXG4gICAgICAgICAgICBcInRvcFwiOiAwLFxuICAgICAgICAgICAgXCJyaWdodFwiOiAzNTAsXG4gICAgICAgICAgICBcImJvdHRvbVwiOiA1MDAsXG4gICAgICAgIH0sXG5cbiAgICAgICAgaW50ZXJzZWN0ZWRSZWN0OiB7XG4gICAgICAgICAgICBcImxlZnRcIjogMCxcbiAgICAgICAgICAgIFwidG9wXCI6IDAsXG4gICAgICAgICAgICBcInJpZ2h0XCI6IDIwMCxcbiAgICAgICAgICAgIFwiYm90dG9tXCI6IDUwMCxcbiAgICAgICAgICAgIFwid2lkdGhcIjogMjAwLFxuICAgICAgICAgICAgXCJoZWlnaHRcIjogNTAwXG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVzdHJpY3Rpb25SZWN0OiB7XG4gICAgICAgICAgICBcImxlZnRcIjogMCxcbiAgICAgICAgICAgIFwidG9wXCI6IDAsXG4gICAgICAgICAgICBcInJpZ2h0XCI6IDgwMCxcbiAgICAgICAgICAgIFwiYm90dG9tXCI6IDUwMCxcbiAgICAgICAgICAgIFwid2lkdGhcIjogODAwLFxuICAgICAgICAgICAgXCJoZWlnaHRcIjogNTAwXG4gICAgICAgIH1cblxuICAgIH1cblxufTtcblxuIl19